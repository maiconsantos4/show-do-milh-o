<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Show do Milh√£o da Embriologia</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Base styles for body and game container */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); /* Darker, richer background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow: hidden; /* Prevent scroll for confetti */
        }
        .game-container {
            background: linear-gradient(160deg, #2c3e50 0%, #1a2533 100%); /* Dark blue-gray gradient */
            border-radius: 2rem; /* More rounded */
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7); /* Deeper shadow */
            padding: 3.5rem;
            max-width: 950px; /* Wider to accommodate elements */
            width: 100%;
            text-align: center;
            color: #ecf0f1; /* Lighter text */
            border: 4px solid #34495e; /* Thicker, darker border */
            position: relative;
            overflow: hidden;
            z-index: 1;
            /* Responsive padding for smaller screens */
            padding: 2rem 1.5rem;
        }
        @media (min-width: 768px) {
            .game-container {
                padding: 3.5rem;
            }
        }

        /* Light pulse animation for game container */
        .game-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0) 70%); /* Stronger light pulse */
            animation: pulse-light 12s infinite alternate;
            pointer-events: none;
        }
        @keyframes pulse-light {
            0% { transform: scale(1); opacity: 0.08; }
            100% { transform: scale(1.3); opacity: 0.2; }
        }

        /* Title styling */
        .title {
            font-size: 3rem; /* Even larger title */
            font-weight: 900;
            color: #f1c40f; /* Brighter gold */
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            margin-bottom: 2rem;
            letter-spacing: 2px;
        }
        @media (min-width: 768px) {
            .title {
                font-size: 4rem;
                margin-bottom: 2.5rem;
            }
        }

        /* Start Screen Specific Styles */
        #startScreen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px; /* Ensure enough space for character */
        }
        .character-selection {
            display: flex;
            gap: 20px;
            margin-bottom: 2rem;
        }
        .character-option {
            width: 100px; /* Smaller for mobile */
            height: 100px;
            background-color: #3498db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            border: 5px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.4), 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        @media (min-width: 640px) {
            .character-option {
                width: 120px;
                height: 120px;
                font-size: 2.5rem;
            }
        }
        .character-option:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.6), 0 8px 20px rgba(0, 0, 0, 0.5);
        }
        .character-option.selected-char {
            border-color: #f1c40f; /* Gold border for selected character */
            transform: scale(1.1);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8), 0 10px 25px rgba(0, 0, 0, 0.6);
        }

        #startButton {
            background: linear-gradient(180deg, #2ecc71 0%, #27ae60 100%); /* Green gradient */
            color: white;
            padding: 1.2rem 3rem; /* Larger button */
            border-radius: 1.5rem; /* More rounded */
            font-size: 1.5rem; /* Larger font */
            font-weight: bold;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease-in-out;
            border: none;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        @media (min-width: 640px) {
            #startButton {
                padding: 1.5rem 4rem;
                font-size: 1.8rem;
            }
        }
        #startButton:hover {
            background: linear-gradient(180deg, #27ae60 0%, #2ecc71 100%);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.5);
        }

        /* Game Screen Specific Styles */
        .question-box {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%); /* Darker blue-gray gradient */
            padding: 2rem;
            border-radius: 1.5rem; /* More rounded */
            margin-bottom: 2rem;
            font-size: 1.5rem; /* Larger font */
            font-weight: bold;
            color: #ecf0f1;
            min-height: 120px; /* Taller */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border: 3px solid #5fa2dd; /* Brighter blue border */
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3), 0 5px 15px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        @media (min-width: 640px) {
            .question-box {
                padding: 2.5rem;
                margin-bottom: 2.5rem;
                font-size: 1.8rem;
                min-height: 160px;
            }
        }
        .question-box.show {
            opacity: 1;
            transform: translateY(0);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem; /* Larger gap */
            margin-bottom: 2rem;
        }
        @media (min-width: 640px) {
            .options-grid {
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
                margin-bottom: 3rem;
            }
        }
        .option-button {
            background: linear-gradient(180deg, #3498db 0%, #2980b9 100%); /* Blue gradient */
            color: white;
            padding: 1rem 1.5rem; /* Larger padding */
            border-radius: 1rem; /* More rounded */
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            border: none;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translateY(30px);
        }
        @media (min-width: 640px) {
            .option-button {
                padding: 1.5rem 2rem;
                font-size: 1.3rem;
            }
        }
        .option-button.show {
            opacity: 1;
            transform: translateY(0);
        }
        .option-button:hover:not(.selected):not(.correct):not(.incorrect) {
            background: linear-gradient(180deg, #2980b9 0%, #3498db 100%);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.5);
        }
        .option-button.selected {
            background: linear-gradient(180deg, #f1c40f 0%, #e67e22 100%); /* Orange-gold gradient for selected */
            color: #2c3e50;
            transform: scale(1.04);
            box-shadow: 0 0 0 5px #f1c40f, 0 12px 20px rgba(0, 0, 0, 0.5);
        }
        .option-button.correct {
            background: linear-gradient(180deg, #2ecc71 0%, #27ae60 100%); /* Green gradient for correct */
            color: white;
            box-shadow: 0 0 0 5px #2ecc71, 0 12px 20px rgba(0, 0, 0, 0.5);
        }
        .option-button.incorrect {
            background: linear-gradient(180deg, #e74c3c 0%, #c0392b 100%); /* Red gradient for incorrect */
            color: white;
            box-shadow: 0 0 0 5px #e74c3c, 0 12px 20px rgba(0, 0, 0, 0.5);
        }
        .option-button.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            filter: grayscale(80%); /* Visually indicate disabled */
        }

        .control-buttons button, .lifeline-buttons button {
            background: linear-gradient(180deg, #9b59b6 0%, #8e44ad 100%); /* Purple gradient */
            color: white;
            padding: 1rem 2rem;
            border-radius: 1rem;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            border: none;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            margin: 0 0.5rem;
            display: inline-flex; /* For icon + text alignment */
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        @media (min-width: 640px) {
            .control-buttons button, .lifeline-buttons button {
                padding: 1.2rem 2.5rem;
                font-size: 1.3rem;
                margin: 0 0.8rem;
                gap: 10px;
            }
        }
        .control-buttons button:hover, .lifeline-buttons button:hover:not(.disabled) {
            background: linear-gradient(180deg, #8e44ad 0%, #9b59b6 100%);
            transform: translateY(-3px) scale(1.01);
            box-shadow: 0 10px 18px rgba(0, 0, 0, 0.4);
        }
        .control-buttons button.disabled, .lifeline-buttons button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: linear-gradient(180deg, #6b46c1 0%, #5a32a3 100%); /* Darker purple when disabled */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        /* Animation for lifeline usage */
        .lifeline-buttons button.used-animation {
            animation: lifeline-pulse 0.5s ease-out;
        }
        @keyframes lifeline-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }


        .message {
            font-size: 1.4rem; /* Larger font */
            margin-top: 1.5rem;
            font-weight: bold;
            min-height: 40px;
            color: #ecf0f1;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        @media (min-width: 640px) {
            .message {
                font-size: 1.6rem;
                margin-top: 2rem;
                min-height: 50px;
            }
        }
        .prize-display {
            font-size: 2.2rem; /* Even larger prize display */
            font-weight: 900;
            margin-bottom: 2rem;
            color: #f1c40f; /* Brighter gold */
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
        }
        @media (min-width: 640px) {
            .prize-display {
                font-size: 2.8rem;
                margin-bottom: 2.5rem;
            }
        }
        .hidden {
            display: none;
        }

        /* Confetti styles */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 9999;
        }
        .confetti {
            position: absolute;
            width: 12px; /* Larger confetti */
            height: 12px;
            background-color: #ffeb3b; /* Yellow */
            opacity: 0;
            animation: confetti-fall 4s forwards; /* Longer animation */
            border-radius: 50%;
        }
        .confetti:nth-child(2n) { background-color: #2ecc71; } /* Green */
        .confetti:nth-child(3n) { background-color: #3498db; } /* Blue */
        .confetti:nth-child(4n) { background-color: #9b59b6; } /* Purple */
        .confetti:nth-child(5n) { background-color: #e74c3c; } /* Red */
        .confetti:nth-child(6n) { background-color: #f39c12; } /* Orange */
        .confetti:nth-child(7n) { background-color: #c0392b; } /* Dark Red */
        .confetti:nth-child(8n) { background-color: #27ae60; } /* Dark Green */


        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotateZ(720deg); opacity: 0; }
        }

        /* Volume slider */
        .volume-control {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ecf0f1;
            z-index: 10;
        }
        .volume-control input[type="range"] {
            -webkit-appearance: none;
            width: 80px; /* Smaller for mobile */
            height: 8px;
            background: #4a5568;
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        @media (min-width: 640px) {
            .volume-control input[type="range"] {
                width: 100px;
            }
        }
        .volume-control input[type="range"]:hover {
            opacity: 1;
        }
        .volume-control input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }
        .volume-control input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }

        /* Universit√°rios display */
        .universitarios-results {
            margin-top: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            text-align: left;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
            color: #ecf0f1;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .universitarios-bar-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .universitarios-bar {
            height: 18px; /* Taller bars */
            background-color: #2ecc71; /* Green for bars */
            border-radius: 3px;
            width: 0%;
            transition: width 1.2s ease-out; /* Slower animation */
        }
        .universitarios-percentage {
            font-weight: bold;
            width: 50px; /* Wider for percentages */
            text-align: right;
        }

        /* Prize Ladder */
        .prize-ladder-container {
            position: fixed; /* Changed to fixed for better mobile positioning */
            top: 50%;
            left: 10px; /* Adjusted for smaller screens */
            transform: translateY(-50%);
            display: flex;
            flex-direction: column-reverse;
            align-items: flex-start;
            gap: 5px;
            padding: 10px; /* Smaller padding */
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            max-height: 90vh; /* Taller */
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
            z-index: 5;
            border: 2px solid #34495e;
            /* Hide on very small screens, or adjust width */
            width: 120px;
        }
        @media (min-width: 768px) {
            .prize-ladder-container {
                left: 20px;
                padding: 15px;
                width: 180px; /* Wider for desktop */
            }
        }
        @media (max-width: 480px) {
            .prize-ladder-container {
                display: none; /* Hide on very small phones to prevent overlap */
            }
        }

        .prize-ladder-item {
            font-size: 0.9rem; /* Slightly larger */
            color: #bdc3c7; /* Lighter gray */
            padding: 6px 10px;
            border-radius: 8px;
            width: 100%; /* Fill container width */
            text-align: right;
            transition: all 0.4s ease-in-out;
        }
        @media (min-width: 768px) {
            .prize-ladder-item {
                font-size: 1rem;
                padding: 8px 15px;
            }
        }
        .prize-ladder-item.current-prize {
            background: linear-gradient(90deg, #f1c40f 0%, #e67e22 100%); /* Gold-orange gradient */
            color: #2c3e50;
            font-weight: 900; /* Extra bold */
            transform: scale(1.1);
            box-shadow: 0 0 15px #f1c40f, 0 0 25px rgba(241, 196, 15, 0.5);
            border: 2px solid #f39c12;
        }
        .prize-ladder-item.safe-level {
            border: 2px solid #2ecc71; /* Brighter green border for safe levels */
            color: #2ecc71;
            font-weight: bold;
        }

        /* Timer */
        .timer-container {
            position: relative;
            width: 80px; /* Smaller timer for mobile */
            height: 80px;
            margin: 0 auto 1.5rem auto;
        }
        @media (min-width: 640px) {
            .timer-container {
                width: 100px;
                height: 100px;
            }
        }
        .timer-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(#e74c3c 0%, #e74c3c var(--timer-progress), transparent var(--timer-progress), transparent 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
            border: 5px solid #c0392b;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.5), 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: background 0.5s linear; /* Smooth color change */
        }
        @media (min-width: 640px) {
            .timer-circle {
                font-size: 2.2rem;
            }
        }
        .timer-circle.warning {
            background: conic-gradient(#f39c12 0%, #f39c12 var(--timer-progress), transparent var(--timer-progress), transparent 100%);
            border-color: #e67e22;
        }
        .timer-circle.danger {
            background: conic-gradient(#e74c3c 0%, #e74c3c var(--timer-progress), transparent var(--timer-progress), transparent 100%);
            border-color: #c0392b;
        }

        /* Modal for Phone a Friend */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85); /* Darker overlay */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: linear-gradient(160deg, #34495e 0%, #2c3e50 100%); /* Consistent gradient */
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.8);
            color: #ecf0f1;
            max-width: 450px; /* Slightly larger */
            width: 90%;
            text-align: center;
            transform: translateY(-50px);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        @media (min-width: 640px) {
            .modal-content {
                padding: 3rem;
                max-width: 550px;
            }
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        .modal-content h3 {
            font-size: 1.8rem; /* Larger heading */
            font-weight: 900;
            margin-bottom: 1.5rem;
            color: #f1c40f; /* Gold heading */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        @media (min-width: 640px) {
            .modal-content h3 {
                font-size: 2.2rem;
                margin-bottom: 1.8rem;
            }
        }
        .modal-content p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            line-height: 1.6;
        }
        @media (min-width: 640px) {
            .modal-content p {
                font-size: 1.2rem;
                margin-bottom: 2.5rem;
            }
        }
        .modal-content button {
            background: linear-gradient(180deg, #2ecc71 0%, #27ae60 100%); /* Green gradient */
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            border: none;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        @media (min-width: 640px) {
            .modal-content button {
                padding: 1rem 2rem;
            }
        }
        .modal-content button:hover {
            background: linear-gradient(180deg, #27ae60 0%, #2ecc71 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        /* Leaderboard Screen */
        #leaderboardScreen {
            background: linear-gradient(160deg, #2c3e50 0%, #1a2533 100%);
            border-radius: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7);
            padding: 3.5rem;
            max-width: 700px;
            width: 100%;
            text-align: center;
            color: #ecf0f1;
            border: 4px solid #34495e;
            position: relative;
            z-index: 1;
        }
        #leaderboardScreen h2 {
            font-size: 2.5rem;
            font-weight: 900;
            color: #f1c40f;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            margin-bottom: 2rem;
            letter-spacing: 2px;
        }
        @media (min-width: 640px) {
            #leaderboardScreen h2 {
                font-size: 3.5rem;
                margin-bottom: 2.5rem;
            }
        }
        #leaderboardList {
            list-style: none;
            padding: 0;
            margin: 0 auto;
            max-width: 500px;
        }
        #leaderboardList li {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 0.8rem 1.2rem;
            margin-bottom: 8px;
            border-radius: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease-in-out;
        }
        @media (min-width: 640px) {
            #leaderboardList li {
                padding: 1rem 1.5rem;
                margin-bottom: 10px;
                font-size: 1.2rem;
            }
        }
        #leaderboardList li:hover {
            background-color: rgba(0, 0, 0, 0.4);
            transform: translateY(-2px);
        }
        #leaderboardList li .rank {
            color: #f1c40f;
            font-size: 1.3rem;
            margin-right: 10px;
        }
        @media (min-width: 640px) {
            #leaderboardList li .rank {
                font-size: 1.4rem;
                margin-right: 15px;
            }
        }
        #leaderboardList li .name {
            flex-grow: 1;
            text-align: left;
        }
        #leaderboardList li .score {
            color: #2ecc71;
            font-size: 1.2rem;
        }
        @media (min-width: 640px) {
            #leaderboardList li .score {
                font-size: 1.3rem;
            }
        }
        #leaderboardLoading {
            color: #bdc3c7;
            font-size: 1.2rem;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">SHOW DO MILH√ÉO <br>DA EMBRIOLOGIA</h1>

        <!-- Volume Control -->
        <div class="volume-control">
            <label for="volumeSlider"><i class="fas fa-volume-up"></i></label>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.5">
        </div>

        <!-- Audio Elements - REPLACE THESE PLACEHOLDER URLs WITH YOUR ACTUAL GAME SOUNDS! -->
        <audio id="backgroundMusic" loop>
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
            <!-- Sugest√£o: M√∫sica de fundo ambiente do programa -->
        </audio>
        <audio id="silvioVoiceCorrect">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" type="audio/mpeg">
            <!-- Sugest√£o: √Åudio da voz do Silvio Santos "Certa Resposta!" -->
        </audio>
        <audio id="silvioVoiceIncorrect">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" type="audio/mpeg">
            <!-- Sugest√£o: √Åudio da voz do Silvio Santos "Que pena!" ou som de resposta errada -->
        </audio>
        <audio id="silvioVoiceQuestion">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3" type="audio/mpeg">
            <!-- Sugest√£o: √Åudio da voz do Silvio Santos introduzindo a pergunta -->
        </audio>
        <audio id="buttonClickSound">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3" type="audio/mpeg">
            <!-- Sugest√£o: Som de clique de bot√£o -->
        </audio>
        <audio id="lifelineSound">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3" type="audio/mpeg">
            <!-- Sugest√£o: Som de uso de uma ajuda (50/50, pular, etc.) -->
        </audio>
        <audio id="timerSound" loop>
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3" type="audio/mpeg">
            <!-- Sugest√£o: Som de rel√≥gio/timer tique-taque -->
        </audio>
        <audio id="phoneRingSound">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" type="audio/mpeg">
            <!-- Sugest√£o: Som de telefone tocando -->
        </audio>
        <audio id="gameOverSound">
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3" type="audio/mpeg">
            <!-- Sugest√£o: Som de fim de jogo / derrota -->
        </audio>

        <div id="startScreen">
            <p class="text-xl mb-6 text-gray-300">Quem vai comandar o jogo? Escolha o apresentador!</p>
            <div class="character-selection mb-10">
                <div class="character-option selected-char" data-character="male">
                    <i class="fas fa-male"></i>
                </div>
                <div class="character-option" data-character="female">
                    <i class="fas fa-female"></i>
                </div>
            </div>
            <p class="text-xl mb-10 text-gray-300">Teste seus conhecimentos sobre Embriologia e se torne o milion√°rio da ci√™ncia!</p>
            <button id="startButton" class="control-buttons button">JOGAR!</button>
        </div>

        <div id="gameScreen" class="hidden">
            <div class="prize-display">Pr√™mio Atual: R$ <span id="prizeDisplay">0</span></div>
            <div class="timer-container">
                <div class="timer-circle" id="timerCircle"></div>
            </div>
            <div class="lifeline-buttons flex justify-center mb-6 flex-wrap gap-4">
                <button id="fiftyFiftyButton" class="button"><i class="fas fa-cut"></i> 50/50</button>
                <button id="skipButton" class="button"><i class="fas fa-forward"></i> Pular</button>
                <button id="universitariosButton" class="button"><i class="fas fa-users"></i> Universit√°rios</button>
                <button id="phoneAFriendButton" class="button"><i class="fas fa-phone-alt"></i> Telefone</button>
            </div>
            <div class="question-box" id="questionText"></div>
            <div class="options-grid" id="optionsContainer">
                <!-- Options will be dynamically inserted here -->
            </div>
            <div class="universitarios-results hidden" id="universitariosResults">
                <!-- Universit√°rios results will be displayed here -->
            </div>
            <div class="message" id="feedbackMessage"></div>
            <div class="control-buttons flex justify-center mt-6 flex-wrap gap-4">
                <button id="confirmButton" class="button hidden">Confirmar Resposta</button>
                <button id="stopButton" class="button hidden">Parar</button>
                <button id="nextButton" class="button hidden">Pr√≥xima Pergunta</button>
                <button id="playAgainButton" class="button hidden">Jogar Novamente</button>
            </div>
        </div>

        <div id="endScreen" class="hidden">
            <h2 class="title text-green-400 mb-8">Fim de Jogo!</h2>
            <p class="text-3xl font-bold mb-4 text-white">Seu Pr√™mio Final:</p>
            <p class="text-5xl font-extrabold text-yellow-400 mb-8" id="finalPrizeDisplay">R$ 0</p>
            <button id="viewLeaderboardButton" class="control-buttons button mb-4">Ver Placar de L√≠deres</button>
            <button id="playAgainEndButton" class="control-buttons button">Jogar Novamente</button>
        </div>

        <div id="leaderboardScreen" class="hidden">
            <h2 class="title">LIGA DO MILH√ÉO</h2>
            <div id="leaderboardLoading">Carregando placar de l√≠deres...</div>
            <ul id="leaderboardList">
                <!-- Leaderboard items will be loaded here -->
            </ul>
            <button id="backToStartButton" class="control-buttons button mt-8">Voltar ao In√≠cio</button>
        </div>
    </div>

    <!-- Prize Ladder Visualization -->
    <div id="prizeLadderContainer" class="prize-ladder-container hidden"></div>

    <!-- Confetti Container -->
    <div id="confettiContainer" class="confetti-container hidden"></div>

    <!-- Phone a Friend Modal -->
    <div id="phoneAFriendModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Telefone para um Amigo</h3>
            <p id="phoneAFriendMessage"></p>
            <button id="closePhoneAFriendModal">Fechar</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Importa as fun√ß√µes necess√°rias do Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, getDocs, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Vari√°veis globais (disponibilizadas pelo ambiente Canvas)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Inicializar Firebase
        let app;
        let db;
        let auth;
        let userId = 'anonymous'; // Default userId

        // Fun√ß√£o ass√≠ncrona para inicializar Firebase e autentica√ß√£o
        async function initializeFirebaseAndAuth() {
            try {
                // Inicializa o aplicativo Firebase
                app = initializeApp(firebaseConfig);
                // Obt√©m a inst√¢ncia do Firestore
                db = getFirestore(app);
                // Obt√©m a inst√¢ncia de autentica√ß√£o
                auth = getAuth(app);

                // Tenta autenticar com o token fornecido pelo ambiente (se existir)
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    // Se n√£o houver token, autentica anonimamente
                    await signInAnonymously(auth);
                }

                // Observa mudan√ßas no estado de autentica√ß√£o do usu√°rio
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        // Se o usu√°rio estiver logado, usa seu UID
                        userId = user.uid;
                        console.log("Usu√°rio autenticado:", userId);
                    } else {
                        // Se o usu√°rio n√£o estiver logado, gera um UUID aleat√≥rio como fallback
                        console.log("Usu√°rio deslogado ou an√¥nimo.");
                        userId = crypto.randomUUID();
                    }
                });
            } catch (error) {
                console.error("Erro ao inicializar Firebase ou autenticar:", error);
                // Em caso de erro, ainda garante que userId tenha um valor
                userId = crypto.randomUUID();
            }
        }

        // Fun√ß√£o global para adicionar pontua√ß√£o ao placar de l√≠deres no Firestore
        window.addScoreToLeaderboard = async (playerName, score) => {
            if (!db) {
                console.error("Firestore n√£o inicializado. N√£o foi poss√≠vel adicionar pontua√ß√£o.");
                return;
            }
            try {
                // Define a refer√™ncia da cole√ß√£o para o placar de l√≠deres (dados p√∫blicos)
                const leaderboardCollectionRef = collection(db, `artifacts/${appId}/public/data/leaderboard`);
                // Adiciona um novo documento com o nome do jogador, pontua√ß√£o, timestamp e userId
                await addDoc(leaderboardRef, {
                    playerName: playerName,
                    score: score,
                    timestamp: serverTimestamp(), // Usa o timestamp do servidor para consist√™ncia
                    userId: userId // Armazena o userId para rastreamento
                });
                console.log("Pontua√ß√£o adicionada ao placar de l√≠deres!");
            } catch (e) {
                console.error("Erro ao adicionar documento ao placar de l√≠deres: ", e);
            }
        };

        // Fun√ß√£o global para carregar e exibir o placar de l√≠deres do Firestore
        window.fetchLeaderboard = async () => {
            if (!db) {
                console.error("Firestore n√£o inicializado. N√£o foi poss√≠vel buscar o placar de l√≠deres.");
                return;
            }
            const leaderboardList = document.getElementById('leaderboardList');
            const leaderboardLoading = document.getElementById('leaderboardLoading');
            leaderboardList.innerHTML = ''; // Limpa a lista existente
            leaderboardLoading.classList.remove('hidden'); // Mostra o indicador de carregamento

            try {
                // Define a refer√™ncia da cole√ß√£o
                const leaderboardCollectionRef = collection(db, `artifacts/${appId}/public/data/leaderboard`);
                // Cria uma query sem orderBy para evitar a necessidade de √≠ndices complexos no Firestore
                const q = query(leaderboardCollectionRef);
                // Obt√©m os documentos da query
                const querySnapshot = await getDocs(q);
                let scores = [];
                // Itera sobre os documentos e adiciona os dados √† array de scores
                querySnapshot.forEach((doc) => {
                    scores.push(doc.data());
                });

                // Ordena as pontua√ß√µes em mem√≥ria (do maior para o menor)
                scores.sort((a, b) => b.score - a.score);

                leaderboardLoading.classList.add('hidden'); // Esconde o indicador de carregamento
                if (scores.length === 0) {
                    leaderboardList.innerHTML = '<li class="text-center text-gray-400">Nenhuma pontua√ß√£o ainda. Seja o primeiro!</li>';
                } else {
                    // Exibe apenas as 10 melhores pontua√ß√µes
                    scores.slice(0, 10).forEach((data, index) => {
                        const listItem = document.createElement('li');
                        listItem.innerHTML = `
                            <span class="rank">${index + 1}¬∫</span>
                            <span class="name">${data.playerName || 'Jogador An√¥nimo'}</span>
                            <span class="score">R$ ${data.score.toLocaleString('pt-BR')}</span>
                        `;
                        leaderboardList.appendChild(listItem);
                    });
                }
            } catch (e) {
                console.error("Erro ao buscar placar de l√≠deres: ", e);
                leaderboardLoading.classList.add('hidden'); // Esconde o indicador mesmo em caso de erro
                leaderboardList.innerHTML = '<li class="text-center text-red-400">Erro ao carregar placar.</li>';
            }
        };

        // Chama a fun√ß√£o de inicializa√ß√£o do Firebase quando o DOM estiver completamente carregado
        document.addEventListener('DOMContentLoaded', initializeFirebaseAndAuth);
    </script>

    <script>
        // Array de perguntas sobre embriologia
        const questions = [
            {
                question: "Qual o nome do processo de fus√£o dos gametas masculino e feminino?",
                options: ["Ovula√ß√£o", "Fecunda√ß√£o", "Nida√ß√£o", "Gastrula√ß√£o"],
                correctAnswer: "Fecunda√ß√£o"
            },
            {
                question: "Onde ocorre a fecunda√ß√£o na maioria dos mam√≠feros, incluindo humanos?",
                options: ["√ötero", "Ov√°rio", "Tuba Uterina", "Vagina"],
                correctAnswer: "Tuba Uterina"
            },
            {
                question: "Qual estrutura se forma ap√≥s a fecunda√ß√£o e antes da clivagem?",
                options: ["M√≥rula", "Blastocisto", "Zigoto", "G√°strula"],
                correctAnswer: "Zigoto"
            },
            {
                question: "Durante qual per√≠odo do desenvolvimento embrion√°rio ocorre a forma√ß√£o dos tr√™s folhetos germinativos (ectoderma, mesoderma, endoderma)?",
                options: ["Segmenta√ß√£o", "Gastrula√ß√£o", "Organog√™nese", "Nida√ß√£o"],
                correctAnswer: "Gastrula√ß√£o"
            },
            {
                question: "Qual folheto germinativo d√° origem ao sistema nervoso e √† epiderme?",
                options: ["Mesoderma", "Endoderma", "Ectoderma", "Notocorda"],
                correctAnswer: "Ectoderma"
            },
            {
                question: "O que √© nida√ß√£o?",
                options: ["A forma√ß√£o do tubo neural", "A implanta√ß√£o do blastocisto no endom√©trio", "A divis√£o celular do zigoto", "A forma√ß√£o da placenta"],
                correctAnswer: "A implanta√ß√£o do blastocisto no endom√©trio"
            },
            {
                question: "Qual a fun√ß√£o do saco vitel√≠nico em embri√µes humanos?",
                options: ["Produ√ß√£o de horm√¥nios", "Troca gasosa", "Forma√ß√£o de c√©lulas sangu√≠neas iniciais", "Armazenamento de nutrientes"],
                correctAnswer: "Forma√ß√£o de c√©lulas sangu√≠neas iniciais"
            },
            {
                question: "Qual o nome do processo de forma√ß√£o de √≥rg√£os a partir dos folhetos germinativos?",
                options: ["Gastrula√ß√£o", "Neurula√ß√£o", "Organog√™nese", "Clivagem"],
                correctAnswer: "Organog√™nese"
            },
            {
                question: "A notocorda, uma estrutura importante no desenvolvimento embrion√°rio, d√° origem a qual parte do corpo?",
                options: ["C√©rebro", "Cora√ß√£o", "Coluna vertebral", "Rins"],
                correctAnswer: "Coluna vertebral"
            },
            {
                question: "Qual o per√≠odo de gesta√ß√£o normal em humanos?",
                options: ["6 meses", "7 meses", "8 meses", "9 meses"],
                correctAnswer: "9 meses"
            },
            {
                question: "Qual o nome da camada mais externa do embri√£o que forma a placenta?",
                options: ["√Çmnio", "C√≥rion", "Alantoide", "Saco Vitel√≠nico"],
                correctAnswer: "C√≥rion"
            },
            {
                question: "A s√≠ndrome de Down √© causada por uma anomalia em qual cromossomo?",
                options: ["Cromossomo 13", "Cromossomo 18", "Cromossomo 21", "Cromossomo X"],
                correctAnswer: "Cromossomo 21"
            },
            {
                question: "Qual estrutura embrion√°ria √© respons√°vel pela prote√ß√£o e hidrata√ß√£o do feto?",
                options: ["Placenta", "Cord√£o Umbilical", "Saco Amni√≥tico", "C√≥rion"],
                correctAnswer: "Saco Amni√≥tico"
            },
            {
                question: "O que √© teratog√™nese?",
                options: ["Forma√ß√£o de g√™meos", "Desenvolvimento de √≥rg√£os", "Forma√ß√£o de anomalias cong√™nitas", "Crescimento celular"],
                correctAnswer: "Forma√ß√£o de anomalias cong√™nitas"
            },
            {
                question: "Qual o nome da c√©lula que resulta da fus√£o do espermatozoide com o √≥vulo?",
                options: ["G√¢meta", "M√≥rula", "Zigoto", "Blast√¥mero"],
                correctAnswer: "Zigoto"
            },
            {
                question: "Qual o folheto germinativo que d√° origem aos m√∫sculos e ossos?",
                options: ["Ectoderma", "Endoderma", "Mesoderma", "Notocorda"],
                correctAnswer: "Mesoderma"
            },
            {
                question: "A segmenta√ß√£o do zigoto resulta na forma√ß√£o de qual estrutura?",
                options: ["G√°strula", "N√™urula", "M√≥rula", "Blastocisto"],
                correctAnswer: "M√≥rula"
            },
            {
                question: "Qual o nome do processo de forma√ß√£o do tubo neural?",
                options: ["Gastrula√ß√£o", "Neurula√ß√£o", "Organog√™nese", "Clivagem"],
                correctAnswer: "Neurula√ß√£o"
            },
            {
                question: "Qual a fun√ß√£o do √¢mnio?",
                options: ["Nutri√ß√£o do embri√£o", "Prote√ß√£o contra choques mec√¢nicos", "Troca gasosa", "Forma√ß√£o da placenta"],
                correctAnswer: "Prote√ß√£o contra choques mec√¢nicos"
            },
            {
                question: "Em que est√°gio o embri√£o se implanta no √∫tero?",
                options: ["Zigoto", "M√≥rula", "Blastocisto", "G√°strula"],
                correctAnswer: "Blastocisto"
            }
        ];


        // Escada de pr√™mios (em Reais)
        const prizeLadder = [
            0,        // In√≠cio
            1000,     // 1¬™ pergunta
            2000,
            3000,
            4000,
            5000,
            10000,    // 6¬™ pergunta - N√≠vel de seguran√ßa 1
            20000,
            30000,
            40000,
            50000,
            100000,   // 11¬™ pergunta - N√≠vel de seguran√ßa 2
            200000,
            300000,
            400000,
            500000,
            1000000   // 16¬™ pergunta - Milh√£o!
        ];

        // N√≠veis de seguran√ßa (√≠ndices no prizeLadder)
        const safePrizeLevels = [0, 6, 11]; // R$0, R$10.000, R$100.000

        let currentQuestionIndex = 0;
        let currentPrizeIndex = 0; // √çndice na escada de pr√™mios
        let selectedOption = null;
        let gameStarted = false;
        let fiftyFiftyUsed = false;
        let skipUsed = false;
        let universitariosUsed = false;
        let phoneAFriendUsed = false;
        let timerInterval;
        let timeLeft = 30; // Tempo em segundos para cada pergunta
        let selectedCharacter = 'male'; // Default character

        // Elementos do DOM
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const endScreen = document.getElementById('endScreen');
        const leaderboardScreen = document.getElementById('leaderboardScreen');
        const startButton = document.getElementById('startButton');
        const playAgainEndButton = document.getElementById('playAgainEndButton');
        const viewLeaderboardButton = document.getElementById('viewLeaderboardButton');
        const backToStartButton = document.getElementById('backToStartButton');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackMessage = document.getElementById('feedbackMessage');
        const prizeDisplay = document.getElementById('prizeDisplay');
        const finalPrizeDisplay = document.getElementById('finalPrizeDisplay');
        const confirmButton = document.getElementById('confirmButton');
        const stopButton = document.getElementById('stopButton');
        const nextButton = document.getElementById('nextButton');
        const playAgainButton = document.getElementById('playAgainButton');
        const backgroundMusic = document.getElementById('backgroundMusic');
        const silvioVoiceCorrect = document.getElementById('silvioVoiceCorrect');
        const silvioVoiceIncorrect = document.getElementById('silvioVoiceIncorrect');
        const silvioVoiceQuestion = document.getElementById('silvioVoiceQuestion');
        const buttonClickSound = document.getElementById('buttonClickSound');
        const lifelineSound = document.getElementById('lifelineSound');
        const timerSound = document.getElementById('timerSound');
        const phoneRingSound = document.getElementById('phoneRingSound');
        const gameOverSound = document.getElementById('gameOverSound');
        const fiftyFiftyButton = document.getElementById('fiftyFiftyButton');
        const skipButton = document.getElementById('skipButton');
        const universitariosButton = document.getElementById('universitariosButton');
        const phoneAFriendButton = document.getElementById('phoneAFriendButton');
        const universitariosResults = document.getElementById('universitariosResults');
        const volumeSlider = document.getElementById('volumeSlider');
        const confettiContainer = document.getElementById('confettiContainer');
        const prizeLadderContainer = document.getElementById('prizeLadderContainer');
        const timerCircle = document.getElementById('timerCircle');
        const phoneAFriendModal = document.getElementById('phoneAFriendModal');
        const phoneAFriendMessage = document.getElementById('phoneAFriendMessage');
        const closePhoneAFriendModal = document.getElementById('closePhoneAFriendModal');
        const characterOptions = document.querySelectorAll('.character-option');


        // Fun√ß√£o para tocar √°udio, reiniciando se j√° estiver tocando para evitar sobreposi√ß√£o
        function playAudio(audioElement) {
            audioElement.pause(); // Pausa para garantir que comece do zero
            audioElement.currentTime = 0; // Reinicia o √°udio
            audioElement.play().catch(e => console.error("Erro ao tocar √°udio:", e));
        }

        // Event Listeners para os bot√µes do jogo
        startButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            startGame();
        });

        confirmButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            clearTimer(); // Para o timer ao confirmar
            checkAnswer();
        });

        stopButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            clearTimer(); // Para o timer ao parar o jogo
            stopGame();
        });

        nextButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            currentQuestionIndex++;
            currentPrizeIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion(); // Carrega a pr√≥xima pergunta
            } else {
                endGame(true, prizeLadder[prizeLadder.length - 1]); // Se todas as perguntas foram respondidas, o jogador ganha o milh√£o
            }
        });

        playAgainButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            resetGame();
            startGame();
        });

        playAgainEndButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            resetGame();
            startGame();
        });

        viewLeaderboardButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            showLeaderboard();
        });

        backToStartButton.addEventListener('click', () => {
            playAudio(buttonClickSound);
            showStartScreen();
        });

        // Event Listeners para as ajudas (lifelines)
        fiftyFiftyButton.addEventListener('click', () => {
            if (!fiftyFiftyUsed && gameStarted && selectedOption === null) {
                playAudio(lifelineSound);
                fiftyFiftyButton.classList.add('used-animation'); // Adiciona anima√ß√£o
                useFiftyFifty();
                setTimeout(() => fiftyFiftyButton.classList.remove('used-animation'), 500); // Remove anima√ß√£o
            }
        });

        skipButton.addEventListener('click', () => {
            if (!skipUsed && gameStarted && selectedOption === null) {
                playAudio(lifelineSound);
                skipButton.classList.add('used-animation');
                clearTimer(); // Limpa o timer ao pular a pergunta
                useSkip();
                setTimeout(() => skipButton.classList.remove('used-animation'), 500);
            }
        });

        universitariosButton.addEventListener('click', () => {
            if (!universitariosUsed && gameStarted && selectedOption === null) {
                playAudio(lifelineSound);
                universitariosButton.classList.add('used-animation');
                useUniversitarios();
                setTimeout(() => universitariosButton.classList.remove('used-animation'), 500);
            }
        });

        phoneAFriendButton.addEventListener('click', () => {
            if (!phoneAFriendUsed && gameStarted && selectedOption === null) {
                playAudio(phoneRingSound);
                phoneAFriendButton.classList.add('used-animation');
                usePhoneAFriend();
                setTimeout(() => phoneAFriendButton.classList.remove('used-animation'), 500);
            }
        });

        closePhoneAFriendModal.addEventListener('click', () => {
            phoneAFriendModal.classList.remove('show'); // Esconde o modal com transi√ß√£o
            setTimeout(() => phoneAFriendModal.classList.add('hidden'), 300); // Esconde ap√≥s a transi√ß√£o
        });

        // Controle de volume para todos os elementos de √°udio
        volumeSlider.addEventListener('input', (event) => {
            const volume = event.target.value;
            backgroundMusic.volume = volume;
            silvioVoiceCorrect.volume = volume;
            silvioVoiceIncorrect.volume = volume;
            silvioVoiceQuestion.volume = volume;
            buttonClickSound.volume = volume;
            lifelineSound.volume = volume;
            timerSound.volume = volume;
            phoneRingSound.volume = volume;
            gameOverSound.volume = volume;
        });

        // Sele√ß√£o de personagem
        characterOptions.forEach(option => {
            option.addEventListener('click', () => {
                document.querySelector('.character-option.selected-char').classList.remove('selected-char');
                option.classList.add('selected-char');
                selectedCharacter = option.dataset.character;
            });
        });

        // Fun√ß√µes de Fluxo do Jogo

        // Mostra uma tela espec√≠fica e esconde as outras
        function showScreen(screenToShow) {
            const screens = [startScreen, gameScreen, endScreen, leaderboardScreen];
            screens.forEach(screen => {
                if (screen === screenToShow) {
                    screen.classList.remove('hidden');
                } else {
                    screen.classList.add('hidden');
                }
            });
        }

        // Exibe a tela inicial e reinicia o jogo
        function showStartScreen() {
            resetGame();
            showScreen(startScreen);
        }

        // Inicia o jogo
        function startGame() {
            showScreen(gameScreen);
            prizeLadderContainer.classList.remove('hidden'); // Mostra a escada de pr√™mios
            backgroundMusic.play().catch(e => console.error("Erro ao tocar m√∫sica de fundo:", e));
            gameStarted = true;
            loadQuestion();
            updateLifelineButtons(); // Atualiza o estado dos bot√µes de ajuda
            confettiContainer.classList.add('hidden'); // Esconde confetes de jogos anteriores
            renderPrizeLadder(); // Renderiza a escada de pr√™mios inicial
        }

        // Carrega a pergunta atual e suas op√ß√µes
        function loadQuestion() {
            selectedOption = null; // Reseta a op√ß√£o selecionada
            feedbackMessage.textContent = ''; // Limpa mensagens de feedback
            confirmButton.classList.add('hidden'); // Esconde o bot√£o de confirmar
            stopButton.classList.remove('hidden'); // Mostra o bot√£o de parar
            nextButton.classList.add('hidden'); // Garante que o bot√£o de pr√≥xima pergunta esteja escondido
            playAgainButton.classList.add('hidden'); // Garante que o bot√£o de jogar novamente esteja escondido
            universitariosResults.classList.add('hidden'); // Esconde resultados dos universit√°rios
            phoneAFriendModal.classList.add('hidden'); // Esconde o modal do telefone

            animatePrizeDisplay(prizeLadder[currentPrizeIndex]); // Anima o pr√™mio atual
            updatePrizeLadderHighlight(); // Atualiza o destaque na escada de pr√™mios

            const questionData = questions[currentQuestionIndex];
            questionText.textContent = questionData.question;
            optionsContainer.innerHTML = ''; // Limpa as op√ß√µes anteriores

            // Anima a entrada da caixa de pergunta
            questionText.classList.remove('show');
            setTimeout(() => {
                questionText.classList.add('show');
            }, 50);

            // Cria e anima os bot√µes de op√ß√£o
            questionData.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-button');
                button.addEventListener('click', () => selectOption(button, option));
                optionsContainer.appendChild(button);

                setTimeout(() => {
                    button.classList.add('show');
                }, 100 + index * 100); // Atraso para anima√ß√£o em cascata
            });

            // Reseta o estado visual de todos os bot√µes de op√ß√£o
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('selected', 'correct', 'incorrect', 'disabled', 'hidden');
            });

            playAudio(silvioVoiceQuestion); // Toca o √°udio de introdu√ß√£o da pergunta
            startTimer(); // Inicia o timer
        }

        // Anima a exibi√ß√£o do pr√™mio atual
        function animatePrizeDisplay(targetPrize) {
            let current = parseInt(prizeDisplay.textContent.replace(/\D/g, '')) || 0;
            const step = Math.ceil(Math.abs(targetPrize - current) / 50); // Calcula o passo da anima√ß√£o
            const increment = targetPrize > current ? step : -step;

            const update = () => {
                current += increment;
                // Garante que o valor n√£o ultrapasse o alvo e para a anima√ß√£o
                if ((increment > 0 && current >= targetPrize) || (increment < 0 && current <= targetPrize)) {
                    current = targetPrize;
                    prizeDisplay.textContent = current.toLocaleString('pt-BR');
                    return;
                }
                prizeDisplay.textContent = current.toLocaleString('pt-BR');
                requestAnimationFrame(update); // Continua a anima√ß√£o
            };
            requestAnimationFrame(update);
        }

        // Renderiza a escada de pr√™mios visual
        function renderPrizeLadder() {
            prizeLadderContainer.innerHTML = '';
            // Itera de tr√°s para frente para exibir do maior para o menor pr√™mio
            for (let i = prizeLadder.length - 1; i >= 0; i--) {
                const prize = prizeLadder[i];
                const item = document.createElement('div');
                item.classList.add('prize-ladder-item');
                item.textContent = `R$ ${prize.toLocaleString('pt-BR')}`;
                if (safePrizeLevels.includes(i)) {
                    item.classList.add('safe-level'); // Adiciona classe para n√≠veis de seguran√ßa
                }
                item.dataset.index = i; // Armazena o √≠ndice para destaque
                prizeLadderContainer.appendChild(item);
            }
            updatePrizeLadderHighlight(); // Atualiza o destaque inicial
        }

        // Atualiza o destaque na escada de pr√™mios para o pr√™mio atual
        function updatePrizeLadderHighlight() {
            document.querySelectorAll('.prize-ladder-item').forEach(item => {
                item.classList.remove('current-prize');
                if (parseInt(item.dataset.index) === currentPrizeIndex) {
                    item.classList.add('current-prize');
                    // Rola para o item atual na escada de pr√™mios
                    setTimeout(() => {
                        item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }, 100);
                }
            });
        }

        // Inicia o timer da pergunta
        function startTimer() {
            clearTimer(); // Limpa qualquer timer anterior
            timeLeft = 30; // Reseta o tempo
            updateTimerDisplay(); // Atualiza a exibi√ß√£o do timer
            timerSound.pause(); // Garante que o som do timer esteja parado no in√≠cio

            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();

                // Toca o som do timer nos √∫ltimos 10 segundos
                if (timeLeft === 10) {
                    playAudio(timerSound);
                } else if (timeLeft < 10 && timerSound.paused) {
                    // Garante que o som continue tocando se o usu√°rio pausar e despausar
                    playAudio(timerSound);
                }
                
                if (timeLeft <= 0) {
                    clearTimer();
                    timerSound.pause(); // Para o som do timer
                    feedbackMessage.textContent = 'Tempo esgotado! Que pena!';
                    feedbackMessage.style.color = '#e74c3c';
                    const questionData = questions[currentQuestionIndex];
                    const allOptionButtons = document.querySelectorAll('.option-button');
                    allOptionButtons.forEach(btn => btn.disabled = true); // Desabilita todas as op√ß√µes
                    // Destaca a resposta correta
                    allOptionButtons.forEach(btn => {
                        if (btn.textContent === questionData.correctAnswer) {
                            btn.classList.add('correct');
                        }
                    });
                    // Calcula o pr√™mio final com base no √∫ltimo n√≠vel de seguran√ßa alcan√ßado
                    let finalPrize = 0;
                    for (let i = safePrizeLevels.length - 1; i >= 0; i--) {
                        if (currentPrizeIndex >= safePrizeLevels[i]) {
                            finalPrize = prizeLadder[safePrizeLevels[i]];
                            break;
                        }
                    }
                    endGame(false, finalPrize); // Termina o jogo
                }
            }, 1000); // A cada 1 segundo
        }

        // Atualiza a exibi√ß√£o visual do timer
        function updateTimerDisplay() {
            const percentage = (timeLeft / 30) * 100;
            timerCircle.style.setProperty('--timer-progress', `${percentage}%`);
            timerCircle.textContent = timeLeft;

            // Altera a cor do timer com base no tempo restante
            timerCircle.classList.remove('warning', 'danger');
            if (timeLeft <= 10 && timeLeft > 5) {
                timerCircle.classList.add('warning');
            } else if (timeLeft <= 5 && timeLeft > 0) {
                timerCircle.classList.add('danger');
            }
        }

        // Limpa o intervalo do timer
        function clearTimer() {
            clearInterval(timerInterval);
            timerSound.pause(); // Pausa o som do timer
            timerSound.currentTime = 0; // Reseta o √°udio do timer
        }

        // Seleciona uma op√ß√£o de resposta
        function selectOption(button, option) {
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected'); // Remove sele√ß√£o de outras op√ß√µes
            });
            button.classList.add('selected'); // Adiciona classe de selecionado
            selectedOption = option;
            confirmButton.classList.remove('hidden'); // Mostra o bot√£o de confirmar
            stopButton.classList.remove('hidden'); // Garante que o bot√£o de parar esteja vis√≠vel
        }

        // Verifica se a resposta selecionada est√° correta
        function checkAnswer() {
            if (!selectedOption) {
                feedbackMessage.textContent = 'Por favor, selecione uma op√ß√£o!';
                return;
            }

            clearTimer(); // Para o timer

            const questionData = questions[currentQuestionIndex];
            const allOptionButtons = document.querySelectorAll('.option-button');

            allOptionButtons.forEach(btn => btn.disabled = true); // Desabilita todas as op√ß√µes ap√≥s a escolha

            confirmButton.classList.add('hidden'); // Esconde o bot√£o de confirmar
            stopButton.classList.add('hidden'); // Esconde o bot√£o de parar

            if (selectedOption === questionData.correctAnswer) {
                feedbackMessage.textContent = 'Certa Resposta! Muito bem! Clique em "Pr√≥xima Pergunta" para continuar.';
                feedbackMessage.style.color = '#2ecc71'; // Cor verde para resposta correta
                playAudio(silvioVoiceCorrect); // Toca √°udio de resposta correta
                // Destaca a op√ß√£o correta
                allOptionButtons.forEach(btn => {
                    if (btn.textContent === questionData.correctAnswer) {
                        btn.classList.add('correct');
                    }
                });
                nextButton.classList.remove('hidden'); // Mostra o bot√£o para a pr√≥xima pergunta
            } else {
                feedbackMessage.textContent = `Que pena! A resposta correta era: ${questionData.correctAnswer}`;
                feedbackMessage.style.color = '#e74c3c'; // Cor vermelha para resposta incorreta
                playAudio(silvioVoiceIncorrect); // Toca √°udio de resposta incorreta
                // Destaca a op√ß√£o selecionada como incorreta e a correta
                allOptionButtons.forEach(btn => {
                    if (btn.textContent === selectedOption) {
                        btn.classList.add('incorrect');
                    }
                    if (btn.textContent === questionData.correctAnswer) {
                        btn.classList.add('correct');
                    }
                });
                // Calcula o pr√™mio final com base no √∫ltimo n√≠vel de seguran√ßa alcan√ßado
                let finalPrize = 0;
                for (let i = safePrizeLevels.length - 1; i >= 0; i--) {
                    if (currentPrizeIndex >= safePrizeLevels[i]) {
                        finalPrize = prizeLadder[safePrizeLevels[i]];
                        break;
                    }
                }
                endGame(false, finalPrize); // Termina o jogo
            }
        }

        // Fun√ß√£o para parar o jogo voluntariamente
        function stopGame() {
            clearTimer(); // Para o timer
            let finalPrize = 0;
            // Calcula o pr√™mio final com base no √∫ltimo n√≠vel de seguran√ßa alcan√ßado
            for (let i = safePrizeLevels.length - 1; i >= 0; i--) {
                if (currentPrizeIndex >= safePrizeLevels[i]) {
                    finalPrize = prizeLadder[safePrizeLevels[i]];
                    break;
                }
            }
            feedbackMessage.textContent = `Voc√™ parou o jogo e levou: R$ ${finalPrize.toLocaleString('pt-BR')}!`;
            feedbackMessage.style.color = '#f1c40f'; // Cor dourada para o pr√™mio
            
            setTimeout(() => {
                endGame(false, finalPrize); // Vai para a tela final com o pr√™mio ganho
            }, 2000);
        }

        // Fun√ß√£o para finalizar o jogo (vit√≥ria ou derrota)
        function endGame(wonMillion, finalPrize = 0) {
            clearTimer(); // Para o timer
            gameScreen.classList.add('hidden'); // Esconde a tela do jogo
            prizeLadderContainer.classList.add('hidden'); // Esconde a escada de pr√™mios
            endScreen.classList.remove('hidden'); // Mostra a tela final
            finalPrizeDisplay.textContent = `R$ ${finalPrize.toLocaleString('pt-BR')}`; // Exibe o pr√™mio final

            // Solicita o nome do jogador para o placar de l√≠deres
            let playerName = prompt("Parab√©ns! Digite seu nome para o placar de l√≠deres:", "Jogador");
            if (!playerName || playerName.trim() === "") {
                playerName = "An√¥nimo";
            }
            window.addScoreToLeaderboard(playerName, finalPrize); // Adiciona a pontua√ß√£o ao placar

            if (wonMillion) {
                endScreen.querySelector('.title').textContent = 'PARAB√âNS! VOC√ä GANHOU 1 MILH√ÉO DE REAIS!';
                endScreen.querySelector('.title').classList.remove('text-green-400');
                endScreen.querySelector('.title').classList.add('text-yellow-400');
                triggerConfetti(); // Ativa a anima√ß√£o de confetes
            } else {
                endScreen.querySelector('.title').textContent = 'Fim de Jogo!';
                endScreen.querySelector('.title').classList.remove('text-yellow-400');
                endScreen.querySelector('.title').classList.add('text-green-400');
                playAudio(gameOverSound); // Toca o som de game over
            }

            backgroundMusic.pause(); // Pausa a m√∫sica de fundo
            backgroundMusic.currentTime = 0; // Reinicia a m√∫sica de fundo
        }

        // Mostra a tela do placar de l√≠deres
        function showLeaderboard() {
            showScreen(leaderboardScreen);
            window.fetchLeaderboard(); // Chama a fun√ß√£o global para buscar o placar
        }

        // Reseta todas as vari√°veis e o estado do jogo para um novo in√≠cio
        function resetGame() {
            clearTimer();
            currentQuestionIndex = 0;
            currentPrizeIndex = 0;
            selectedOption = null;
            gameStarted = false;
            fiftyFiftyUsed = false;
            skipUsed = false;
            universitariosUsed = false;
            phoneAFriendUsed = false;
            feedbackMessage.textContent = '';
            // Esconde todas as telas e mostra a inicial
            startScreen.classList.remove('hidden');
            gameScreen.classList.add('hidden');
            endScreen.classList.add('hidden');
            leaderboardScreen.classList.add('hidden');
            updateLifelineButtons(); // Reseta o estado dos bot√µes de ajuda
            confettiContainer.classList.add('hidden'); // Esconde os confetes
            prizeDisplay.textContent = '0'; // Reseta o pr√™mio exibido
            timerCircle.style.setProperty('--timer-progress', '100%'); // Reseta o timer visual
            timerCircle.textContent = '';
            timerCircle.classList.remove('warning', 'danger');
            prizeLadderContainer.classList.add('hidden'); // Esconde a escada de pr√™mios
        }

        // Atualiza o estado (habilitado/desabilitado) dos bot√µes de ajuda
        function updateLifelineButtons() {
            fiftyFiftyButton.disabled = fiftyFiftyUsed;
            skipButton.disabled = skipUsed;
            universitariosButton.disabled = universitariosUsed;
            phoneAFriendButton.disabled = phoneAFriendUsed;

            // Adiciona/remove classes para estilo visual de desabilitado
            if (fiftyFiftyUsed) fiftyFiftyButton.classList.add('disabled'); else fiftyFiftyButton.classList.remove('disabled');
            if (skipUsed) skipButton.classList.add('disabled'); else skipButton.classList.remove('disabled');
            if (universitariosUsed) universitariosButton.classList.add('disabled'); else universitariosButton.classList.remove('disabled');
            if (phoneAFriendUsed) phoneAFriendButton.classList.add('disabled'); else phoneAFriendButton.classList.remove('disabled');
        }

        // L√≥gica da ajuda 50/50
        function useFiftyFifty() {
            if (fiftyFiftyUsed || !gameStarted || selectedOption !== null) return;

            fiftyFiftyUsed = true;
            updateLifelineButtons();

            const questionData = questions[currentQuestionIndex];
            // Filtra as op√ß√µes incorretas que n√£o est√£o escondidas
            const allOptions = Array.from(document.querySelectorAll('.option-button:not(.hidden)'));
            const incorrectOptions = allOptions.filter(btn => btn.textContent !== questionData.correctAnswer);

            let optionsToHide = [];
            // Seleciona duas op√ß√µes incorretas para esconder
            while (optionsToHide.length < 2 && incorrectOptions.length > 0) {
                const randomIndex = Math.floor(Math.random() * incorrectOptions.length);
                optionsToHide.push(incorrectOptions.splice(randomIndex, 1)[0]);
            }

            // Esconde e desabilita as op√ß√µes selecionadas
            optionsToHide.forEach(btn => {
                btn.classList.add('hidden');
                btn.disabled = true;
            });

            feedbackMessage.textContent = 'Duas op√ß√µes incorretas foram removidas!';
            feedbackMessage.style.color = '#bdc3c7';
        }

        // L√≥gica da ajuda Pular Pergunta
        function useSkip() {
            if (skipUsed || !gameStarted || selectedOption !== null) return;

            skipUsed = true;
            updateLifelineButtons();

            feedbackMessage.textContent = 'Pergunta pulada! Voc√™ n√£o perde pontos.';
            feedbackMessage.style.color = '#bdc3c7';

            currentQuestionIndex++;
            currentPrizeIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion(); // Carrega a pr√≥xima pergunta
            } else {
                endGame(true, prizeLadder[prizeLadder.length - 1]); // Se pular a √∫ltima, ganha o milh√£o
            }
        }

        // L√≥gica da ajuda Universit√°rios
        function useUniversitarios() {
            if (universitariosUsed || !gameStarted || selectedOption !== null) return;

            universitariosUsed = true;
            updateLifelineButtons();
            universitariosResults.innerHTML = ''; // Limpa resultados anteriores
            universitariosResults.classList.remove('hidden'); // Mostra a √°rea de resultados

            const questionData = questions[currentQuestionIndex];
            const options = questionData.options;
            const correctAnswer = questionData.correctAnswer;

            let votes = {};
            let totalVotes = 100; // Total de porcentagem

            // Define uma porcentagem alta para a resposta correta
            let correctPercentage = Math.floor(Math.random() * (75 - 50 + 1)) + 50; // Entre 50% e 75%
            votes[correctAnswer] = correctPercentage;
            totalVotes -= correctPercentage;

            let remainingOptions = options.filter(opt => opt !== correctAnswer);
            let remainingVotesPerOption = 0;
            if (remainingOptions.length > 0) {
                remainingVotesPerOption = Math.floor(totalVotes / remainingOptions.length);
            }
            

            // Distribui os votos restantes entre as op√ß√µes incorretas
            remainingOptions.forEach(opt => {
                votes[opt] = remainingVotesPerOption;
            });

            // Adiciona o resto dos votos aleatoriamente
            let remainder = totalVotes % remainingOptions.length;
            if (remainder > 0 && remainingOptions.length > 0) {
                for (let i = 0; i < remainder; i++) {
                    const randomIndex = Math.floor(Math.random() * remainingOptions.length);
                    votes[remainingOptions[randomIndex]]++;
                }
            }

            // Garante que a soma seja 100% (ajuste final se necess√°rio devido a arredondamentos)
            let currentSum = Object.values(votes).reduce((sum, val) => sum + val, 0);
            if (currentSum !== 100) {
                const diff = 100 - currentSum;
                if (diff > 0 && remainingOptions.length > 0) {
                    // Adiciona a diferen√ßa √† op√ß√£o correta ou a uma aleat√≥ria
                    votes[correctAnswer] += diff;
                } else if (diff < 0 && remainingOptions.length > 0) {
                    // Remove a diferen√ßa de uma op√ß√£o aleat√≥ria (n√£o a correta)
                    const randomIndex = Math.floor(Math.random() * remainingOptions.length);
                    votes[remainingOptions[randomIndex]] += diff;
                }
            }


            // Exibe as barras de porcentagem
            options.forEach(option => {
                const percentage = votes[option] || 0;
                const barContainer = document.createElement('div');
                barContainer.classList.add('universitarios-bar-container');
                barContainer.innerHTML = `
                    <span>${option}:</span>
                    <div class="flex-grow bg-gray-600 rounded-full overflow-hidden">
                        <div class="universitarios-bar" style="width: 0%;"></div>
                    </div>
                    <span class="universitarios-percentage">${percentage}%</span>
                `;
                universitariosResults.appendChild(barContainer);

                // Anima o preenchimento das barras
                setTimeout(() => {
                    barContainer.querySelector('.universitarios-bar').style.width = `${percentage}%`;
                }, 100);
            });

            feedbackMessage.textContent = 'Os universit√°rios deram suas opini√µes!';
            feedbackMessage.style.color = '#bdc3c7';
        }

        // L√≥gica da ajuda Telefone para um Amigo
        function usePhoneAFriend() {
            if (phoneAFriendUsed || !gameStarted || selectedOption !== null) return;

            phoneAFriendUsed = true;
            updateLifelineButtons();

            const questionData = questions[currentQuestionIndex];
            const correctAnswer = questionData.correctAnswer;
            const options = questionData.options;

            let friendMessage = "";
            const randomChance = Math.random();

            // Diferentes n√≠veis de certeza do amigo
            if (randomChance < 0.7) { // 70% de chance de dar a resposta correta com confian√ßa
                friendMessage = `Tenho quase certeza que a resposta √© a "${correctAnswer}".`;
            } else if (randomChance < 0.9) { // 20% de chance de dar uma dica amb√≠gua
                const incorrectOptions = options.filter(opt => opt !== correctAnswer);
                const hintOption = incorrectOptions[Math.floor(Math.random() * incorrectOptions.length)];
                friendMessage = `Hmm, estou em d√∫vida entre a "${correctAnswer}" e a "${hintOption}". Mas se eu tivesse que chutar, iria na "${correctAnswer}".`;
            } else { // 10% de chance de n√£o saber
                friendMessage = "Essa √© bem dif√≠cil... N√£o consigo te ajudar nessa, desculpe!";
            }

            phoneAFriendMessage.textContent = friendMessage;
            phoneAFriendModal.classList.remove('hidden');
            phoneAFriendModal.classList.add('show'); // Mostra o modal com transi√ß√£o

            feedbackMessage.textContent = 'Seu amigo te deu uma dica!';
            feedbackMessage.style.color = '#bdc3c7';
        }

        // Ativa a anima√ß√£o de confetes
        function triggerConfetti() {
            confettiContainer.classList.remove('hidden');
            for (let i = 0; i < 300; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDelay = Math.random() * 4 + 's';
                confetti.style.animationDuration = (3 + Math.random() * 3) + 's';
                confetti.style.backgroundColor = ['#f1c40f', '#2ecc71', '#3498db', '#9b59b6', '#e74c3c', '#f39c12', '#c0392b', '#27ae60'][Math.floor(Math.random() * 8)];
                confettiContainer.appendChild(confetti);
            }
            // Limpa os confetes ap√≥s um tempo
            setTimeout(() => {
                confettiContainer.innerHTML = '';
                confettiContainer.classList.add('hidden');
            }, 6000);
        }

        // Garante que a m√∫sica comece a tocar apenas ap√≥s a intera√ß√£o do usu√°rio e define o volume inicial
        document.addEventListener('DOMContentLoaded', () => {
            backgroundMusic.volume = volumeSlider.value;
            silvioVoiceCorrect.volume = volumeSlider.value;
            silvioVoiceIncorrect.volume = volumeSlider.value;
            silvioVoiceQuestion.volume = volumeSlider.value;
            buttonClickSound.volume = volumeSlider.value;
            lifelineSound.volume = volumeSlider.value;
            timerSound.volume = volumeSlider.value;
            phoneRingSound.volume = volumeSlider.value;
            gameOverSound.volume = volumeSlider.value;
        });

    </script>
</body>
</html>
